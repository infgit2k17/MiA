@model ApartmentDetailsVM

@{
    var x = Model.RatingStars * 20;
    var today = DateTime.Today;
}

<div class="container body-content">
    <h2>Offer description</h2>
    <hr />
    <div id="basiclayout">
        <div id="right" class="rlt-right">
            <h3 style="font-size: 35px; margin-top: 10px; margin-bottom: 25px">@Model.Title</h3>
            <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="6000">
                <ol class="carousel-indicators">
                    @foreach (var details in Model.Images)
                    {
                        @if (Model.Images.First() == details)
                        {
                            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                        }
                        else
                        {
                            <li data-target="#myCarousel" data-slide-to="1" class=""></li>
                        }
                    }
                </ol>
                <div class="carousel-inner" role="listbox">
                    @foreach (var details in Model.Images)
                    {
                        @if (Model.Images.First() == details)
                        {
                            <div class="item active" alt="Microsoft Azure" class="img-responsive">
                                <img src="@details" class="img-responsive">
                            </div>
                        }
                        else
                        {
                            <div class="item">
                                <img src="@details" class="img-responsive">
                            </div>
                        }
                    }
                </div>
                <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <div class="hotel-description">
                <div class="hotel-description-div">
                    <div class="Search_offer" style="height:150px; margin-bottom: 15px;width: 70%">
                        <div class="left_img">
                            <h4 style="font-weight: bold;color:black; text-align: center; padding-top: 40px;">PRICE:</h4>
                            <h5 style="color:black">@Model.Price $</h5>
                        </div>
                        <div class="right_desc" style="width:70%">
                            <div class="SearchOffleft" style="border-left:1px solid #000; height:120px">
                                <h4 style="font-weight: bold">RATING</h4>
                                <div class="star-ratings-css">
                                    <div class="star-ratings-css-top" style="width: @x%"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                    <div class="star-ratings-css-bottom"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                </div>
                                <h4 style="margin-top: 20px">@Model.RatingStars.ToString("F")</h4>
                            </div>
                            <div class="SearchOffleft" style="border-left:1px solid #000; height:120px; padding-top: 30px;">
                                <section class="contentButton">
                                    <div class="Searchv2" style="margin:0 auto">
                                        <button id="btnCheck" data-id="@Model.Id" class="buttonv2" href="" onclick="onBtnCl()">Book now</button>
                                    </div>
                                    @*@Html.ActionLink("Description", "Description", new { id = aparment.id }); *@
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="hotel-description-div">
                    <h3>Description</h3>
                    <p>@Model.Description</p>
                </div>
                <div class="hotel-description-div">

                    @*<p>COMMENTS</p>
                        <fieldset class="comment">
                            <textarea cols="80" rows="4" name="tresc" class="expanded placeholder" placeholder="Leave a comment"></textarea>
                        </fieldset>
                        <section class="contentButton">
                            <div class="Search">
                                <button type="submit" class="button">Submit</button>
                            </div>
                        </section>*@

                    <div class="w3-content">
                        @foreach (var item in Model.Comments)
                        {
                            <div class="mySlides">
                                <h3>Comments</h3>
                                <div class="commentfield">
                                    <h4>@item.AuthorName</h4>
                                    <p>@item.Comment</p>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div id="left" class="rlt-left">
            <table class="StartTable">
                <thead>
                    <tr>
                        <th colspan="3">Destination</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="3"><input class="sb-destination" id="destin" /></td>
                    </tr>
                </tbody>
                <thead>
                    <tr>
                        <th>Date of arrival</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input id="departing" type="date" min=@today required></td>
                    </tr>
                </tbody>
                <thead>
                    <tr>
                        <th>Date of departure</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input id="returning" type="date" min=@today required></td>
                    </tr>
                </tbody>
                <thead>
                    <tr>
                        <th>Guests</th>
                    </tr>
                    <tr>
                        <td><input type="number" id="count_picker" min="1"></td>
                    </tr>
                </thead>
            </table>
            <br />
            <section class="contentButton">
                <div class="Search">
                    <button id="btnSerch" class="button" onclick="uriaction2()">Search</button>
                </div>
                <div class="Search">
                    <a rel="nofollow" class="button" href="">Clear</a>
                </div>
            </section>
        </div>
    </div>

</div>

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert-dev.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

    <script>
            function onBtnCl() {
                var button = $(this);
                swal({
                    title: "Confirmation required!",
                    text: "Do you want to order the apartment?" /*+ button.attr("data-id") + "?"*/,
                    //type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "green",
                    confirmButtonText: "Yes, order it!",
                    cancelButtonText: "No"
                },
                    function (isConfirm) {
                        if (isConfirm) {
                            $.ajax({
                                url: '/api/apartments/' + button.attr("data-id"),
                                type: 'POST',
                                contentType: 'application/json; charset=utf-8',
                                success: function () {
                                    toastr.success("Apartment has been ordered");
                                    table.ajax.reload();
                                },
                                error: function () {
                                    toastr.error("Error ordering apartment");
                                }
                            });
                        }
                    })
        }
    </script>
}

@section Styles{
    <link rel='stylesheet' type='text/css' href='https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css' />
    <link rel='stylesheet' type='text/css' href='https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css' />
}